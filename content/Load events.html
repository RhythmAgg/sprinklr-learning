<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Load events</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="0f5c1ce8-e301-442f-bbca-05ada27e200e" class="page sans"><header><h1 class="page-title">Load events</h1><p class="page-description"></p></header><div class="page-body"><p id="2664d9ba-ac2b-4a99-988b-816eaee1e582" class="">The lifecycle of an HTML page has three important events:</p><ul id="27c1d797-6762-40e4-b89a-d5ca467fe02c" class="bulleted-list"><li style="list-style-type:disc"><code>DOMContentLoaded</code> – the browser fully loaded HTML, and the DOM tree is built, but external resources like pictures <code>&lt;img&gt;</code> and stylesheets may not yet have loaded.</li></ul><ul id="00dbbf8f-301b-4ff8-9a65-398a17325e28" class="bulleted-list"><li style="list-style-type:disc"><code>load</code> – not only HTML is loaded, but also all the external resources: images, styles etc.</li></ul><ul id="926de297-6ba0-4c4a-b80e-172bfbc2b022" class="bulleted-list"><li style="list-style-type:disc"><code>beforeunload/unload</code> – the user is leaving the page.</li></ul><p id="2dbe57a1-ac53-4b77-9918-446c5fde2834" class="">Each event may be useful:</p><ul id="2cb0b76c-4a94-483f-801b-f40ca46ca12c" class="bulleted-list"><li style="list-style-type:disc"><code>DOMContentLoaded</code> event – DOM is ready, so the handler can lookup DOM nodes, initialize the interface.</li></ul><ul id="42c3485a-906e-4ff1-bc9f-97ecf433bbc0" class="bulleted-list"><li style="list-style-type:disc"><code>load</code> event – external resources are loaded, so styles are applied, image sizes are known etc.</li></ul><ul id="9afac8eb-a72a-4e03-b66c-5e8ac43f7fa1" class="bulleted-list"><li style="list-style-type:disc"><code>beforeunload</code> event – the user is leaving: we can check if the user saved the changes and ask them whether they really want to leave.</li></ul><ul id="1e06c798-1a92-4dad-b613-2014cb179a4b" class="bulleted-list"><li style="list-style-type:disc"><code>unload</code> – the user almost left, but we still can initiate some operations, such as sending out statistics.</li></ul><p id="0b7aa0e9-9474-409f-9cbe-2eeb3238c1f7" class="">for each event, refer <a href="https://javascript.info/onload-ondomcontentloaded">https://javascript.info/onload-ondomcontentloaded</a></p><h2 id="38da92e4-28c8-43a7-b660-af869fd707fd" class="">Scripts, async and defer</h2><p id="35b2f690-2650-4069-9d7f-19dd82afb58e" class="">When the browser loads HTML and comes across a <code>&lt;script&gt;...&lt;/script&gt;</code> tag, it can’t continue building the DOM. It must execute the script right now. The same happens for external scripts <code>&lt;script src=&quot;...&quot;&gt;&lt;/script&gt;</code>: the browser must wait for the script to download, execute the downloaded script, and only then can it process the rest of the page.</p><ol type="1" id="169d162f-6b96-4795-ac9a-e3b0b32470bc" class="numbered-list" start="1"><li>Scripts can’t see DOM elements below them, so they can’t add handlers etc.</li></ol><ol type="1" id="d2858102-f65c-4765-ba9b-0a37a5ab86e0" class="numbered-list" start="2"><li>If there’s a bulky script at the top of the page, it “blocks the page”. Users can’t see the page content till it downloads and runs:</li></ol><p id="51d390d7-2486-464c-92f0-d1a4f9e9a28a" class="">The <code>defer</code> attribute tells the browser not to wait for the script. Instead, the browser will continue to process the HTML, build DOM. The script loads “in the background”, and then runs when the DOM is fully built.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a7986ce1-158e-467a-a35c-4de35e48c8bb" class="code"><code class="language-JavaScript">&lt;p&gt;...content before scripts...&lt;/p&gt;

&lt;script&gt;
  document.addEventListener(&#x27;DOMContentLoaded&#x27;, () =&gt; alert(&quot;DOM ready after defer!&quot;));
&lt;/script&gt;

&lt;script defer src=&quot;https://javascript.info/article/script-async-defer/long.js?speed=1&quot;&gt;&lt;/script&gt;

&lt;p&gt;...content after scripts...&lt;/p&gt;</code></pre><p id="c94e47a8-7832-4614-941d-eecca5f92eb9" class="">In other words:</p><ul id="efe6809f-eca0-448d-ad83-515070be9dfe" class="bulleted-list"><li style="list-style-type:disc">Scripts with <code>defer</code> never block the page.</li></ul><ul id="0cb5ff3c-e799-40a3-ac86-13ff90b30920" class="bulleted-list"><li style="list-style-type:disc">Scripts with <code>defer</code> always execute when the DOM is ready (but before <code>DOMContentLoaded</code> event).</li></ul><p id="72c4dc78-f6ce-41ec-b957-ccbc8c9c8256" class=""><strong>Deferred scripts keep their relative order, just like regular scripts.</strong></p><p id="e1904b17-7ff9-4179-a69f-6069be45680a" class=""><strong>The </strong><code><strong>defer</strong></code><strong> attribute is only for external scripts</strong></p><p id="8dc7863f-3fbf-4ffc-8416-b35646d19bf8" class="">The <code>defer</code> attribute is ignored if the <code>&lt;script&gt;</code> tag has no <code>src</code>.</p><p id="859d88da-fd0f-4eaf-af32-551991714ff3" class="">
</p><p id="5520b4dd-a63d-47a8-978a-782ef1badec7" class="">The <code>async</code> attribute is somewhat like <code>defer</code>. It also makes the script non-blocking. But it has important differences in the behavior.</p><p id="ba03d879-6b24-4f63-9a4f-450648d95156" class="">The <code>async</code> attribute means that a script is completely independent:</p><ul id="db9b2919-492f-4166-93d5-fc2bae056af8" class="bulleted-list"><li style="list-style-type:disc">The browser doesn’t block on <code>async</code> scripts (like <code>defer</code>).</li></ul><ul id="e7d9c783-d080-467f-afe1-25c820698b76" class="bulleted-list"><li style="list-style-type:disc">Other scripts don’t wait for <code>async</code> scripts, and <code>async</code> scripts don’t wait for them.</li></ul><ul id="9353903a-d7b8-4d4c-85e5-edfe8c1cadd6" class="bulleted-list"><li style="list-style-type:disc"><code>DOMContentLoaded</code> and async scripts don’t wait for each other:<ul id="335fee69-e846-46ad-9410-3d60c90453f0" class="bulleted-list"><li style="list-style-type:circle"><code>DOMContentLoaded</code> may happen both before an async script (if an async script finishes loading after the page is complete)</li></ul><ul id="95e973f8-e3b9-4ed2-b791-433abaf1db24" class="bulleted-list"><li style="list-style-type:circle">…or after an async script (if an async script is short or was in HTTP-cache)</li></ul></li></ul><p id="44f8bd8d-c37a-4e3b-90d3-71873db8b9db" class="">
</p><p id="82681f87-b4b1-4963-be1b-a7d1d0c23ecc" class="">There’s one more important way of adding a script to the page.</p><p id="0974f477-f4ae-4db3-ab0a-a76014631392" class="">We can create a script and append it to the document dynamically using JavaScript:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0855e06e-7b38-44e4-9fa0-4878283adb2e" class="code"><code class="language-JavaScript">let script = document.createElement(&#x27;script&#x27;);
script.src = &quot;/article/script-async-defer/long.js&quot;;
document.body.append(script); // (*)
</code></pre><p id="6aa55e5a-4b90-4006-a129-c0afcb353eac" class=""><strong>Dynamic scripts behave as “async” by default.</strong></p><p id="6062229f-652d-40ac-97e8-fa65b3504d6e" class="">That is:</p><ul id="58095dc6-a754-4b73-b5f3-8807e9da2a70" class="bulleted-list"><li style="list-style-type:disc">They don’t wait for anything, nothing waits for them.</li></ul><ul id="85a96f8d-ecc5-4fd3-8e38-e9385754fca0" class="bulleted-list"><li style="list-style-type:disc">The script that loads first – runs first (“load-first” order).</li></ul><p id="e8e7bd86-ca61-400a-8ecd-9cdd0d0b5c33" class="">This can be changed if we explicitly set <code>script.async=false</code>. Then scripts will be executed in the document order, just like <code>defer</code>.</p><p id="5c2ef93c-31ee-41d5-9808-b48d0af950a1" class="">The browser allows us to track the loading of external resources – scripts, iframes, pictures and so on.</p><p id="ce2f023d-e970-4955-ae3e-384b4cbd1874" class="">There are two events for it:</p><ul id="552ee83f-46d0-4dd5-b1e7-d1292124991f" class="bulleted-list"><li style="list-style-type:disc"><code>onload</code> – successful load,</li></ul><ul id="5b8977ea-36e1-4a3b-abe5-4a25bb1d8fc9" class="bulleted-list"><li style="list-style-type:disc"><code>onerror</code> – an error occurred.</li></ul><p id="854d6f0d-9a74-4c70-99f3-97351000441a" class="">Events <code>onload</code>/<code>onerror</code> track only the loading itself.</p><p id="0d529c68-2443-46b1-93df-c11dd9faf499" class="">Errors that may occur during script processing and execution are out of scope for these events. That is: if a script loaded successfully, then <code>onload</code> triggers, even if it has programming errors in it. To track script errors, one can use <code>window.onerror</code> global handler.</p><h3 id="3800f97b-8778-4f96-adc0-3dd628a64630" class="">Cross origin</h3><p id="70a6fd96-afcb-468f-a2d3-6bcfaafd841b" class="">Or, to be more precise, one origin (domain/port/protocol triplet) can’t access the content from another one. So even if we have a subdomain, or just another port, these are different origins with no access to each other.</p><p id="5e33178a-f354-44cc-9879-70e77878156e" class=""><strong>To allow cross-origin access, the </strong><code><strong>&lt;script&gt;</strong></code><strong> tag needs to have the </strong><code><strong>crossorigin</strong></code><strong> attribute, plus the remote server must provide special headers.</strong></p><p id="cc2fa8d3-6a8f-4806-a2e5-b6d64e461e20" class="">There are three levels of cross-origin access:</p><ol type="1" id="aad65d84-c6b0-4594-b30e-b27c36b1663f" class="numbered-list" start="1"><li><strong>No </strong><code><strong>crossorigin</strong></code><strong> attribute</strong> – access prohibited.</li></ol><ol type="1" id="c586ad39-2360-438d-b61a-22971e4bb803" class="numbered-list" start="2"><li><code><strong>crossorigin=&quot;anonymous&quot;</strong></code> – access allowed if the server responds with the header <code>Access-Control-Allow-Origin</code> with <code></code> or our origin. Browser does not send authorization information and cookies to remote server.</li></ol><ol type="1" id="cecd37ee-d8f7-4393-94ca-1c9d72799678" class="numbered-list" start="3"><li><code><strong>crossorigin=&quot;use-credentials&quot;</strong></code> – access allowed if the server sends back the header <code>Access-Control-Allow-Origin</code> with our origin and <code>Access-Control-Allow-Credentials: true</code>. Browser sends authorization information and cookies to remote server.</li></ol><p id="1be22ab4-9d82-4ed8-abd1-b8b974c97cb7" class="">We can choose between <code>&quot;anonymous&quot;</code> (no cookies sent, one server-side header needed) and <code>&quot;use-credentials&quot;</code> (sends cookies too, two server-side headers needed).</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>